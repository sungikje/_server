# file-manager
## 1. 목표
여러 형태의 파일들을 서버에 업로드 및 삭제, 조회, 다운로드 할 수 있는 서버 구축<br>
현재 1:1 서버-클라이언트 관계에서 파일 압축 과정을 디테일하게 확인해보고자 하는 것이 목표

<br><br>

## 2. 요구사항
1. 클라이언트들의 아래 파일 확장자들의 업로드 기능

   1. 파일 확장자
   
      1. Text

          1. txt, csv, json, xml

      2. Binary

          1. Image(JPEG, PNG, GIF)
          2. Video(MP4, AVI)
          3. Audio(MP3)
          4. Compressed file(ZIP, TAR)

      3. etc

          PDF, EXCEL, MD
      
      4. 파일 용량은 80MB(4K Ultra HD 영상 15초 기준)로 제한

    3. 파일 업로드는 2가지의 과정으로 이루어짐

        1. 서버에서 파일 메타데이터를 확인 및 저장 가능 여부 확인 
          
            1. 파일 확장자, 용량 조건에 부합하지 않는 경우는 실패로 응답, 그 외는 업르도 진행
            2. 업로드 진행 시 파일 업로드 성공 여부 또한 응답으로 줘야 한다.
          
2. 현재 업로드된 파일 조회 기능

    1. 클라이언트로부터 요청을 받았을 때 1-1~3을 기준으로 JSON 형태로 파일의 메타 데이터들로 응답
    2. 현재는 서버-클라이언트 1:1 매핑 관계이므로 클라이언트를 식별할 수 있는 작업은 필요 X, 추후에 개선 진행 예정
3. 업로드 된 파일 다운로드 기능

    1. 클라이언트로부터 파일 ID를 입력으로 받아 해당 파일 응답
4. 업로드 된 파일 삭제 기능

    1. 파일 ID를 입력으로 받아 DB에서 해당 파일 ID를 가진 파일 휴지통으로 이동

<br><br>


### 서버
1. 업로드된 파일 조회 기능

    1. 클라이언트로부터 요청 받았을 때 일부 파일 메타데이터들을 JSON 형태로 응답
2. 파일 업로드 요청 

    1. 파일 메타데이터 유효성 검사

        1. 파일 메타데이터 검사 성공 시 파일 업로드 프로세스 진행
        2. 파일 메타데이터 검사 실패 시 실패 이유 응답
3. 파일 다운로드 기능

    1. 파일 ID가 유효한 경우 파일 다운로드 실행
    2. 그 외 오류 응답

4. 업로드 된 파일 삭제 기능

    1. 파일 ID를 입력으로 받아 DB에서 해당 파일 ID를 가진 파일 휴지통으로 이동

<br><br>

### 클라이언트
클라이언트는 CLI 도구로 제작 목표, 유저와 반복해서 상호작용하며 진행 
1. 업로드된 파일 조회 기능

    1. CLI 메뉴창에서 선택 시 서버로부터 받은 JSON 데이터 1~... 인덱싱 진행 후 콘솔에 출력
    2. 콘솔 출력 후에는 다시 상위 메뉴로 이동
2. 파일 업로드 기능

    1. 메뉴 선택 시 로컬 경로 입력 출력
    
        1. 로컬 경로 입력 유효한 경우 서버에 파일 메타 데이터 업로드 요청
            
            1. 이 때 파일 메타데이터도 함께 전송 
        2. 유효하지 않은 경우 에러 출력 및 상위 메뉴 이동
3. 파일 다운로드 기능

    1. 메뉴 선택 시 고유 파일 ID, 다운 받을 경로 입력 출력

        1. 파일 ID, 경로 유효성 검사
        
            1. 우선 경로 유효성을 클라이언트 사이드에서 진행

                1. 유효하지 않은 경우 상위 메뉴로 이동
            2. 유효한 경우 서버에 요청 및 다운로드
4. 파일 삭제 기능

    1. 파일 ID를 입력으로 요청 

 
<br><br>

## 3. 기술셋
### 1. 서버 및 클라이언트
서버와 클라이언트는 모두 Go를 이용해 진행 예정

### 2. DB
우선 DB는 파일의 메타 데이터 저장을 위한 공간과 실제 파일을 저장하는 공간 2가지가 필요하다.

우선 메타 데이터를 저장하는데는 추후에 보다 다양한 파일 메타데이터 핸들링을 목적으로 MongoDB를 사용할 예정이며 아래 형태로 메타 데이터를 다룰 예정
```
{
  "_id": "64a7f23b1e5a2c",
  "originalFilename": "example.mp4",
  "storedFilename": "example_20241229.mp4",
  "fileSize": 1132131,
  "uploadedAt": "2024-12-29T10:15:30Z"
}
```
- originalFilename은 client가 업로드하는 파일 이름이며 storedFilename은 server에 저장되는 파일 이름이다. 이를 분리한 이유는 만약 originalFilename 그대로 저장하게 된다면 client가 같은 이름으로 같은 경로에 파일을 업로드하지 못하기에 분리했다.<br>현재로선 경로를 여러 개를 설정하는 방식을 사용하지 않을 목적이다.
<br>

실제 파일 저장은 로컬 파일 시스템을 이용해 저장 및 관리 

<br><br>

## 4. 운영 방식
1. 클라이언트에서 서버로 파일 업로드 시 소규모 시스템이기에 파일 메타데이터를 먼저 보내 검증받는 방식이 아닌 파일 자체를 보내고 서버에서 검증하는 방식으로 진행.
2. 서버-클라이언트 프로토콜은 HTTP/HTTPS 이용한 RESTful API 사용

<br><br>

## go pj 관련 debug
1. server-mongodb
go에서 MongoDB 사용하는데 필요한 Driver 설치 필요.<br>
해당 드라이버는 시스템 측면에서 다운되는 것이 아니라 go mod에서 설치되어 관리된다.
